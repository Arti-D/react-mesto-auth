(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{29:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),s=n(18),i=n.n(s),o=n(8),r=(n(29),n(22)),l=n(2),u=n(3),p=n.p+"static/media/logo.bbe2a6ea.svg",d=n(0);var h=function(e){var t=Object(u.h)();return Object(d.jsxs)("header",{className:"header",children:[Object(d.jsx)("a",{href:"https://github.com/Arti-D/react-mesto-auth",target:"_blank",className:"header__logo-link",rel:"noreferrer",children:Object(d.jsx)("img",{className:"header__logo",alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f",src:p})}),"/signin"===t.pathname&&Object(d.jsx)(o.b,{to:"/signup",className:"header__link",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),"/signup"===t.pathname&&Object(d.jsx)(o.b,{to:"/signin",className:"header__link",children:"\u0412\u043e\u0439\u0442\u0438"}),e.isLoggedIn&&Object(d.jsxs)("div",{className:"header__wrapp",children:[Object(d.jsx)("p",{className:"header__email",children:e.email}),Object(d.jsx)("button",{onClick:function(){e.onSignOut()},className:"header__button header__link",children:"\u0412\u044b\u0439\u0442\u0438"})]})]})},m=c.a.createContext();var j=function(e){var t=e.card,n=c.a.useContext(m),a=t.owner===n._id,s="elems__remove-btn ".concat(a?"elems__remove-btn_visible":"elems__remove-btn_hidden"),i=t.likes.some((function(e){return e===n._id})),o="elems__like ".concat(i?"elems__like_status_active":"");return Object(d.jsxs)("li",{className:"elems__item elem",children:[Object(d.jsx)("img",{src:t.link,alt:t.name,className:"elems__img",onClick:function(){e.onCardClick({url:t.link,title:t.name})}}),Object(d.jsxs)("div",{className:"elems__wrapper",children:[Object(d.jsx)("h2",{className:"elems__title",children:t.name}),Object(d.jsxs)("div",{className:"elems__like-wrapper",children:[Object(d.jsx)("button",{type:"button",className:o,onClick:function(){e.onCardLike(t)}}),Object(d.jsx)("p",{className:"elems__number-of-likes",children:t.likes.length})]})]}),Object(d.jsx)("button",{className:s,type:"button",onClick:function(){e.onCardDelete(t)}})]})};var b=function(e){var t=c.a.useContext(m);return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("section",{className:"profile",children:[Object(d.jsxs)("div",{className:"profile__main",children:[Object(d.jsxs)("div",{className:"profile__avatar",children:[Object(d.jsx)("img",{className:"profile__avatar-img",src:t.avatar,alt:"\u0430\u0432\u0430\u0442\u0430\u0440 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f ".concat(t.name)}),Object(d.jsx)("button",{className:"profile__avatar-btn",type:"button",onClick:e.onEditAvatar})]}),Object(d.jsxs)("div",{className:"profile__info",children:[Object(d.jsxs)("div",{className:"profile__wrapper",children:[Object(d.jsx)("h1",{className:"profile__title",children:t.name}),Object(d.jsx)("button",{onClick:e.onEditProfile,"aria-label":"edit",title:"edit",type:"button",className:"profile__edit-button"})]}),Object(d.jsx)("p",{className:"profile__subtitle",children:t.about})]})]}),Object(d.jsx)("button",{className:"profile__add-button",onClick:e.onAddPlace,"aria-label":"edit",title:"add",type:"button"})]}),Object(d.jsx)("section",{className:"elems",children:Object(d.jsx)("ul",{className:"elems__list",children:e.cards.map((function(t){return Object(d.jsx)(j,{card:t,onCardLike:e.onCardLike,onCardClick:e.onCardClick,onCardDelete:e.onCardDelete},t._id)}))})})]})};var _=function(e){var t=c.a.useState(""),n=Object(l.a)(t,2),a=n[0],s=n[1],i=c.a.useState(""),o=Object(l.a)(i,2),r=o[0],u=o[1];return Object(d.jsxs)("div",{className:"form",children:[Object(d.jsx)("h2",{className:"form__title",children:"\u0412\u0445\u043e\u0434"}),Object(d.jsxs)("form",{className:"form__content",onSubmit:function(t){t.preventDefault(),e.onSubmit(r,a)},children:[Object(d.jsx)("input",{type:"email",className:"form__input",placeholder:"Email",onChange:function(e){s(e.target.value)}}),Object(d.jsx)("input",{type:"password",className:"form__input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",onChange:function(e){u(e.target.value)}}),Object(d.jsx)("button",{type:"submit",className:"form__submit-btn",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})};var f=function(e){var t=c.a.useState(""),n=Object(l.a)(t,2),a=n[0],s=n[1],i=c.a.useState(""),r=Object(l.a)(i,2),u=r[0],p=r[1];return Object(d.jsxs)("div",{className:"form",children:[Object(d.jsx)("h2",{className:"form__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(d.jsxs)("form",{className:"form__content",onSubmit:function(t){t.preventDefault(),e.onSubmit(u,a)},children:[Object(d.jsx)("input",{type:"email",className:"form__input",placeholder:"Email",onChange:function(e){s(e.target.value)}}),Object(d.jsx)("input",{type:"password",className:"form__input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",onChange:function(e){p(e.target.value)}}),Object(d.jsx)("button",{className:"form__submit-btn",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"}),Object(d.jsxs)("span",{className:"form__question",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?",Object(d.jsx)(o.b,{className:"form__link",to:"/signin",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})]})};var O=function(){var e=(new Date).getFullYear();return Object(d.jsx)("footer",{className:"footer",children:Object(d.jsxs)("p",{className:"footer__copyright",children:["\xa9 ",e," Mesto Russia"]})})};var x=function(e){return Object(d.jsx)("div",{className:"popup popup-img ".concat(e.card&&"popup_opened"),children:Object(d.jsxs)("div",{className:"popup-img__content",children:[Object(d.jsx)("img",{src:e.card&&e.card.url,alt:e.card&&e.card.title,className:"popup-img__picture"}),Object(d.jsx)("p",{className:"popup-img__caption",children:e.card&&e.card.title}),Object(d.jsx)("button",{type:"button",className:"popup__close-btn",onClick:e.onClose})]})})};var g=function(e){return Object(d.jsx)("div",{className:"popup popup-".concat(e.name," ").concat(e.isOpen&&"popup_opened"),children:Object(d.jsxs)("div",{className:"popup__content",children:[Object(d.jsx)("h2",{className:"popup__title",children:e.title}),Object(d.jsxs)("form",{name:e.name,className:"popup__form popup__form_".concat(e.name),noValidate:!0,onSubmit:e.onSubmit,children:[e.children,Object(d.jsx)("button",{className:"popup__btn popup__btn_".concat(e.name),type:"submit",children:e.buttonText})]}),Object(d.jsx)("button",{type:"button",className:"popup__close-btn",onClick:e.onClose})]})})};var v=function(e){var t=c.a.useState(""),n=Object(l.a)(t,2),a=n[0],s=n[1],i=c.a.useState(""),o=Object(l.a)(i,2),r=o[0],u=o[1],p=c.a.useContext(m);return c.a.useEffect((function(){s(p.name),u(p.about)}),[p,e.isOpen]),Object(d.jsxs)(g,{name:"edit",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser(a,r)},buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",children:[Object(d.jsx)("input",{id:"name-input",name:"name",type:"text",placeholder:"\u0418\u043c\u044f",className:"popup__input popup__input_type_name",minLength:"2",maxLength:"40",autoComplete:"off",required:!0,value:a||"",onChange:function(e){s(e.target.value)}}),Object(d.jsx)("span",{id:"name-input-error",className:"error"}),Object(d.jsx)("input",{id:"about-input",name:"about",type:"text",placeholder:"\u041e \u0441\u0435\u0431\u0435",className:"popup__input popup__input_type_about",minLength:"2",maxLength:"200",autoComplete:"off",required:!0,value:r||"",onChange:function(e){u(e.target.value)}}),Object(d.jsx)("span",{id:"about-input-error",className:"error"})]})};var N=function(e){var t=Object(a.useRef)();return Object(d.jsxs)(g,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"avatar",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",children:[Object(d.jsx)("input",{id:"avatar-link-input",className:"popup__input popup__input_type_link",type:"url",name:"avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",autoComplete:"off",required:!0,ref:t}),Object(d.jsx)("span",{id:"avatar-link-input-error",className:"error"})]})};var k=function(e){var t=c.a.useState(""),n=Object(l.a)(t,2),a=n[0],s=n[1],i=c.a.useState(""),o=Object(l.a)(i,2),r=o[0],u=o[1];return c.a.useEffect((function(){u(""),s("")}),[e.isOpen]),Object(d.jsxs)(g,{name:"add",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddPlace({name:a,link:r})},buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",children:[Object(d.jsx)("input",{id:"img-title-input",className:"popup__input popup__input_type_title",type:"text",name:"name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",maxLength:"30",minLength:"2",autoComplete:"off",onChange:function(e){s(e.target.value)},value:a}),Object(d.jsx)("span",{id:"img-title-input-error",className:"error"}),Object(d.jsx)("input",{id:"img-link-input",className:"popup__input popup__input_type_link",type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",autoComplete:"off",required:!0,onChange:function(e){u(e.target.value)},value:r}),Object(d.jsx)("span",{id:"img-link-input-error",className:"error"})]})};var C=function(e){var t="popup-register-status__img ".concat(e.isSuccessStatus?"popup-register-status__img_ok":"popup-register-status__img_wrong");return Object(d.jsx)("div",{className:"popup popup-".concat(e.name," ").concat(e.isOpen&&"popup_opened"),children:Object(d.jsxs)("div",{className:"popup__content",children:[Object(d.jsx)("div",{className:t}),Object(d.jsx)("p",{className:"popup__title popup__title_register",children:e.isSuccessStatus?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437."}),Object(d.jsx)("button",{type:"button",className:"popup__close-btn",onClick:e.onClose})]})})},y=n(20),S=n(21),A=new(function(){function e(t){var n=t.url,a=t.headers;Object(y.a)(this,e),this._url=n,this._headers=a}return Object(S.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))}},{key:"getAllInfo",value:function(){return Promise.all([this.getUserInfo(),this.getCards()])}},{key:"getCards",value:function(){return fetch("".concat(this._url,"/cards"),{method:"GET",headers:this._headers,credentials:"include"}).then(this._checkResponse)}},{key:"getUserInfo",value:function(){return fetch("".concat(this._url,"/users/me"),{method:"GET",headers:this._headers,credentials:"include"}).then(this._checkResponse)}},{key:"addCard",value:function(e){return fetch("".concat(this._url,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link}),credentials:"include"}).then(this._checkResponse)}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about;return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:n}),credentials:"include"}).then(this._checkResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:this._headers,credentials:"include"}).then(this._checkResponse)}},{key:"addLike",value:function(e){return fetch("".concat(this._url,"/cards/").concat(e,"/likes"),{method:"PUT",headers:this._headers,credentials:"include"}).then(this._checkResponse)}},{key:"delLike",value:function(e){return fetch("".concat(this._url,"/cards/").concat(e,"/likes"),{method:"DELETE",headers:this._headers,credentials:"include"}).then(this._checkResponse)}},{key:"newAvatar",value:function(e){var t=e.avatar;return fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t}),credentials:"include"}).then(this._checkResponse)}}]),e}())({url:"http://mesto.arti.nomoredomains.club",headers:{Accept:"application/json","Content-type":"application/json"}}),T=n(23),E=n(24),L=function(e){var t=e.component,n=Object(E.a)(e,["component"]);return Object(d.jsx)(u.b,{children:function(){return n.loggedIn?Object(d.jsx)(t,Object(T.a)({},n)):Object(d.jsx)(u.a,{to:"/signin"})}})},P="http://mesto.arti.nomoredomains.club",w=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))};var D=Object(u.i)((function(){var e=c.a.useState(!1),t=Object(l.a)(e,2),n=t[0],a=t[1],s=c.a.useState(!1),i=Object(l.a)(s,2),o=i[0],p=i[1],j=c.a.useState(!1),g=Object(l.a)(j,2),y=g[0],S=g[1],T=c.a.useState(null),E=Object(l.a)(T,2),D=E[0],I=E[1],R=c.a.useState({}),U=Object(l.a)(R,2),J=U[0],F=U[1],q=c.a.useState(!1),G=Object(l.a)(q,2),H=G[0],B=G[1],M=c.a.useState(!1),V=Object(l.a)(M,2),Y=V[0],z=V[1],K=c.a.useState(""),Q=Object(l.a)(K,2),W=Q[0],X=Q[1],Z=c.a.useState([]),$=Object(l.a)(Z,2),ee=$[0],te=$[1];function ne(){A.getAllInfo().then((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];F(n.data),te(a.data),X(n.data.email)})).catch((function(e){return console.log(e)}))}function ae(){p(!1),a(!1),S(!1),z(!1),I(null)}c.a.useEffect((function(){fetch("".concat(P,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"}).then((function(e){return w(e)})).then((function(e){return e})).then((function(e){e&&(re(!0),ce.push("/"))})).catch((function(e){return console.log(e)})),ne()}),[]);var ce=Object(u.g)(),se=c.a.useState(!1),ie=Object(l.a)(se,2),oe=ie[0],re=ie[1];return Object(d.jsx)("div",{className:"page",children:Object(d.jsxs)(m.Provider,{value:J,children:[Object(d.jsx)(h,{isLoggedIn:oe,email:W,onSignOut:function(){fetch("".concat(P,"/logOut"),{method:"HEAD",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"}).then((function(e){return!!e.ok})).then((function(e){e&&(ce.push("/signin"),re(!1),X(""))})).catch((function(e){return console.log(e)}))}}),Object(d.jsxs)(u.d,{children:[Object(d.jsx)(u.b,{path:"/signin",children:Object(d.jsx)(_,{onSubmit:function(e,t){(function(e,t){return fetch("".concat(P,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:e,email:t}),credentials:"include"}).then((function(e){return w(e)}))})(e,t).then((function(e){re(!0),ce.push("/"),ne()})).catch((function(e){console.log(e)}))}})}),Object(d.jsx)(u.b,{path:"/signup",isOpen:Y,children:Object(d.jsx)(f,{onSubmit:function(e,t){(function(e,t){return fetch("".concat(P,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then((function(e){return w(e)}))})(e,t).then((function(e){B(!0),ce.push("/signin")})).catch((function(e){console.log(e),B(!1)})).finally((function(){z(!0)}))}})}),Object(d.jsx)(L,{path:"/",loggedIn:oe,component:b,onEditProfile:function(){a(!0)},onAddPlace:function(){p(!0)},onEditAvatar:function(){S(!0)},onCardClick:function(e){I(e)},cards:ee,onCardLike:function(e){e.likes.some((function(e){return e===J._id}))?A.delLike(e._id).then((function(t){te((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){return console.log(e)})):A.addLike(e._id).then((function(t){te((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){return console.log(e)}))},onCardDelete:function(e){A.deleteCard(e._id).then((function(t){te((function(t){return t.filter((function(t){return t._id!==e._id}))}))})).catch((function(e){return console.log(e)}))}})]}),Object(d.jsx)(O,{}),Object(d.jsx)(C,{isOpen:Y,onClose:ae,isSuccessStatus:H}),Object(d.jsx)(N,{isOpen:y,onClose:ae,onUpdateAvatar:function(e){A.newAvatar(e).then((function(e){F(e.data),ae()})).catch((function(e){return console.log(e)}))}}),Object(d.jsx)(k,{isOpen:o,onClose:ae,onAddPlace:function(e){A.addCard(e).then((function(e){ae(),te([e].concat(Object(r.a)(ee)))})).catch((function(e){return console.log(e)}))}}),Object(d.jsx)(v,{isOpen:n,onClose:ae,onUpdateUser:function(e,t){A.setUserInfo({name:e,about:t}).then((function(e){F(e.data),ae()})).catch((function(e){return console.log(e)}))}}),Object(d.jsx)(x,{card:D,onClose:ae})]})})})),I=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),s(e),i(e)}))};i.a.render(Object(d.jsx)(o.a,{children:Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(D,{})})}),document.getElementById("root")),I()}},[[36,1,2]]]);
//# sourceMappingURL=main.19233ab1.chunk.js.map